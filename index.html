<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout Logger</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Storage API using localStorage
        window.storage = {
            async get(key) {
                const value = localStorage.getItem(key);
                return value ? { key, value, shared: false } : null;
            },
            async set(key, value) {
                localStorage.setItem(key, value);
                return { key, value, shared: false };
            },
            async delete(key) {
                localStorage.removeItem(key);
                return { key, deleted: true, shared: false };
            }
        };

        // SVG Icons
        const Plus = () => (
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
        );

        const Trash2 = () => (
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
        );

        const Check = () => (
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
        );

        const X = () => (
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        );

        const Fire = () => (
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path>
          </svg>
        );

        function WorkoutLogger() {
          const [workouts, setWorkouts] = useState([]);
          const [exercises, setExercises] = useState([]);
          const [activeWorkout, setActiveWorkout] = useState(null);
          const [showWorkoutForm, setShowWorkoutForm] = useState(false);
          const [showExerciseForm, setShowExerciseForm] = useState(false);
          const [workoutName, setWorkoutName] = useState('');
          const [exerciseData, setExerciseData] = useState({
            name: '',
            sets: '',
            reps: '',
            weight: ''
          });

          useEffect(() => {
            loadWorkouts();
          }, []);

          useEffect(() => {
            saveWorkouts();
          }, [workouts]);

          const loadWorkouts = async () => {
            try {
              const result = await window.storage.get('workouts');
              if (result && result.value) {
                setWorkouts(JSON.parse(result.value));
              }
            } catch (error) {
              console.log('No existing workouts found');
            }
          };

          const saveWorkouts = async () => {
            try {
              await window.storage.set('workouts', JSON.stringify(workouts));
            } catch (error) {
              console.error('Error saving workouts:', error);
            }
          };

          const startWorkout = () => {
            if (workoutName.trim()) {
              const workout = {
                id: Date.now(),
                name: workoutName,
                date: new Date().toISOString(),
                exercises: [],
                completed: false
              };
              setActiveWorkout(workout);
              setExercises([]);
              setWorkoutName('');
              setShowWorkoutForm(false);
            }
          };

          const addExercise = () => {
            if (exerciseData.name.trim() && exerciseData.sets && exerciseData.reps) {
              const exercise = {
                id: Date.now(),
                ...exerciseData,
                sets: parseInt(exerciseData.sets),
                reps: parseInt(exerciseData.reps),
                weight: exerciseData.weight ? parseFloat(exerciseData.weight) : 0
              };
              setExercises([...exercises, exercise]);
              setExerciseData({ name: '', sets: '', reps: '', weight: '' });
              setShowExerciseForm(false);
            }
          };

          const completeWorkout = () => {
            if (activeWorkout && exercises.length > 0) {
              const completedWorkout = {
                ...activeWorkout,
                exercises: exercises,
                completed: true,
                completedAt: new Date().toISOString()
              };
              setWorkouts([completedWorkout, ...workouts]);
              setActiveWorkout(null);
              setExercises([]);
            }
          };

          const cancelWorkout = () => {
            if (window.confirm('Cancel this workout? All exercises will be lost.')) {
              setActiveWorkout(null);
              setExercises([]);
            }
          };

          const deleteWorkout = (id) => {
            if (window.confirm('Delete this workout?')) {
              setWorkouts(workouts.filter(w => w.id !== id));
            }
          };

          const deleteExercise = (id) => {
            setExercises(exercises.filter(e => e.id !== id));
          };

          const clearAll = async () => {
            if (window.confirm('Delete all workout history?')) {
              setWorkouts([]);
              try {
                await window.storage.delete('workouts');
              } catch (error) {
                console.error('Error clearing workouts:', error);
              }
            }
          };

          const totalWorkouts = workouts.length;
          const totalExercises = workouts.reduce((sum, w) => sum + w.exercises.length, 0);
          const thisWeek = workouts.filter(w => {
            const workoutDate = new Date(w.date);
            const today = new Date();
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
            return workoutDate >= weekAgo;
          }).length;

          // Active workout view
          if (activeWorkout) {
            return (
              <div className="min-h-screen bg-black text-white">
                <div className="max-w-2xl mx-auto p-6">
                  {/* Header */}
                  <div className="mb-8">
                    <div className="flex items-center justify-between mb-2">
                      <h1 className="text-3xl font-bold">{activeWorkout.name}</h1>
                      <div className="flex items-center gap-2 text-orange-500">
                        <Fire />
                        <span className="text-2xl font-bold">{exercises.length}</span>
                      </div>
                    </div>
                    <p className="text-gray-400 text-sm">
                      {new Date(activeWorkout.date).toLocaleString()}
                    </p>
                  </div>

                  {/* Exercises List */}
                  <div className="space-y-3 mb-6">
                    {exercises.map((exercise, index) => (
                      <div key={exercise.id} className="bg-zinc-900 rounded-lg p-4 border border-zinc-800">
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <div className="flex items-center gap-3 mb-2">
                              <span className="text-orange-500 font-bold text-lg">{index + 1}</span>
                              <h3 className="text-lg font-semibold">{exercise.name}</h3>
                            </div>
                            <div className="flex gap-4 text-sm text-gray-400">
                              <span>{exercise.sets} sets</span>
                              <span>Ã—</span>
                              <span>{exercise.reps} reps</span>
                              {exercise.weight > 0 && (
                                <>
                                  <span>Ã—</span>
                                  <span>{exercise.weight} kg</span>
                                </>
                              )}
                            </div>
                          </div>
                          <button
                            onClick={() => deleteExercise(exercise.id)}
                            className="p-2 text-red-500 hover:bg-red-950 rounded transition-colors"
                          >
                            <Trash2 />
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* Add Exercise Form */}
                  {showExerciseForm ? (
                    <div className="bg-zinc-900 rounded-lg p-6 mb-4 border border-zinc-800">
                      <h3 className="text-lg font-semibold mb-4">Add Exercise</h3>
                      <div className="space-y-3">
                        <input
                          type="text"
                          value={exerciseData.name}
                          onChange={(e) => setExerciseData({...exerciseData, name: e.target.value})}
                          className="w-full bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-orange-500"
                          placeholder="Exercise name"
                          autoFocus
                        />
                        <div className="grid grid-cols-3 gap-3">
                          <input
                            type="number"
                            value={exerciseData.sets}
                            onChange={(e) => setExerciseData({...exerciseData, sets: e.target.value})}
                            className="bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-orange-500"
                            placeholder="Sets"
                          />
                          <input
                            type="number"
                            value={exerciseData.reps}
                            onChange={(e) => setExerciseData({...exerciseData, reps: e.target.value})}
                            className="bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-orange-500"
                            placeholder="Reps"
                          />
                          <input
                            type="number"
                            value={exerciseData.weight}
                            onChange={(e) => setExerciseData({...exerciseData, weight: e.target.value})}
                            className="bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-orange-500"
                            placeholder="kg"
                            step="0.5"
                          />
                        </div>
                        <div className="flex gap-2">
                          <button
                            onClick={addExercise}
                            className="flex-1 bg-orange-600 hover:bg-orange-700 text-white rounded-lg py-3 font-semibold flex items-center justify-center gap-2 transition-colors"
                          >
                            <Check />
                            Add
                          </button>
                          <button
                            onClick={() => setShowExerciseForm(false)}
                            className="px-6 bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg py-3 font-semibold transition-colors"
                          >
                            <X />
                          </button>
                        </div>
                      </div>
                    </div>
                  ) : (
                    <button
                      onClick={() => setShowExerciseForm(true)}
                      className="w-full bg-zinc-900 hover:bg-zinc-800 border-2 border-dashed border-zinc-700 rounded-lg py-4 font-semibold flex items-center justify-center gap-2 transition-colors mb-4"
                    >
                      <Plus />
                      Add Exercise
                    </button>
                  )}

                  {/* Action Buttons */}
                  <div className="flex gap-3">
                    <button
                      onClick={completeWorkout}
                      disabled={exercises.length === 0}
                      className="flex-1 bg-orange-600 hover:bg-orange-700 disabled:bg-zinc-800 disabled:text-zinc-600 text-white rounded-lg py-4 font-bold text-lg transition-colors"
                    >
                      Complete Workout
                    </button>
                    <button
                      onClick={cancelWorkout}
                      className="px-6 bg-zinc-900 hover:bg-zinc-800 border border-zinc-700 text-white rounded-lg py-4 font-semibold transition-colors"
                    >
                      Cancel
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          // Main dashboard view
          return (
            <div className="min-h-screen bg-black text-white">
              <div className="max-w-4xl mx-auto p-6">
                {/* Header */}
                <div className="mb-8">
                  <h1 className="text-4xl font-bold mb-6">Workout Logger</h1>
                  
                  {/* Stats */}
                  <div className="grid grid-cols-3 gap-4 mb-6">
                    <div className="bg-gradient-to-br from-orange-600 to-red-600 rounded-xl p-6">
                      <div className="text-4xl font-bold mb-1">{totalWorkouts}</div>
                      <div className="text-sm text-orange-100">Total Workouts</div>
                    </div>
                    <div className="bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl p-6">
                      <div className="text-4xl font-bold mb-1">{totalExercises}</div>
                      <div className="text-sm text-purple-100">Total Exercises</div>
                    </div>
                    <div className="bg-gradient-to-br from-blue-600 to-cyan-600 rounded-xl p-6">
                      <div className="text-4xl font-bold mb-1">{thisWeek}</div>
                      <div className="text-sm text-blue-100">This Week</div>
                    </div>
                  </div>

                  {/* Start Workout Button */}
                  {showWorkoutForm ? (
                    <div className="bg-zinc-900 rounded-lg p-6 border border-zinc-800">
                      <h3 className="text-lg font-semibold mb-4">Start New Workout</h3>
                      <div className="flex gap-3">
                        <input
                          type="text"
                          value={workoutName}
                          onChange={(e) => setWorkoutName(e.target.value)}
                          className="flex-1 bg-black border border-zinc-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-orange-500"
                          placeholder="Workout name (e.g., Leg Day, Push Day)"
                          autoFocus
                          onKeyPress={(e) => e.key === 'Enter' && startWorkout()}
                        />
                        <button
                          onClick={startWorkout}
                          className="bg-orange-600 hover:bg-orange-700 text-white rounded-lg px-6 py-3 font-semibold flex items-center gap-2 transition-colors"
                        >
                          <Check />
                          Start
                        </button>
                        <button
                          onClick={() => setShowWorkoutForm(false)}
                          className="bg-zinc-800 hover:bg-zinc-700 text-white rounded-lg px-6 py-3 font-semibold transition-colors"
                        >
                          <X />
                        </button>
                      </div>
                    </div>
                  ) : (
                    <button
                      onClick={() => setShowWorkoutForm(true)}
                      className="w-full bg-orange-600 hover:bg-orange-700 text-white rounded-lg py-4 font-bold text-lg flex items-center justify-center gap-2 transition-colors"
                    >
                      <Plus />
                      Start Workout
                    </button>
                  )}
                </div>

                {/* Workout History */}
                <div>
                  <h2 className="text-2xl font-bold mb-4">History</h2>
                  {workouts.length === 0 ? (
                    <div className="text-center py-16 text-gray-500">
                      <div className="text-6xl mb-4">ðŸ’ª</div>
                      <p className="text-lg">No workouts yet</p>
                      <p className="text-sm">Start your first workout to track your progress</p>
                    </div>
                  ) : (
                    <div className="space-y-4">
                      {workouts.map(workout => (
                        <div key={workout.id} className="bg-zinc-900 rounded-lg p-6 border border-zinc-800 hover:border-zinc-700 transition-colors">
                          <div className="flex items-start justify-between mb-4">
                            <div>
                              <h3 className="text-xl font-bold mb-1">{workout.name}</h3>
                              <p className="text-sm text-gray-400">
                                {new Date(workout.date).toLocaleDateString('en-US', {
                                  weekday: 'long',
                                  year: 'numeric',
                                  month: 'long',
                                  day: 'numeric',
                                  hour: '2-digit',
                                  minute: '2-digit'
                                })}
                              </p>
                            </div>
                            <button
                              onClick={() => deleteWorkout(workout.id)}
                              className="p-2 text-red-500 hover:bg-red-950 rounded transition-colors"
                            >
                              <Trash2 />
                            </button>
                          </div>
                          
                          <div className="space-y-2">
                            {workout.exercises.map((exercise, index) => (
                              <div key={exercise.id} className="bg-black rounded-lg p-3 flex items-center gap-3">
                                <span className="text-orange-500 font-bold">{index + 1}</span>
                                <div className="flex-1">
                                  <div className="font-medium">{exercise.name}</div>
                                  <div className="text-sm text-gray-400">
                                    {exercise.sets} Ã— {exercise.reps}
                                    {exercise.weight > 0 && ` Ã— ${exercise.weight}kg`}
                                  </div>
                                </div>
                              </div>
                            ))}
                          </div>
                          
                          <div className="mt-4 pt-4 border-t border-zinc-800 text-sm text-gray-400">
                            {workout.exercises.length} exercises completed
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                </div>

                {workouts.length > 0 && (
                  <div className="mt-8 text-center">
                    <button
                      onClick={clearAll}
                      className="text-sm text-gray-500 hover:text-red-500 transition-colors"
                    >
                      Clear all history
                    </button>
                  </div>
                )}
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WorkoutLogger />);
    </script>
</body>
</html>